function ElementBuilder(e){this.element=document.createElement(e),this.text=function(e){return this.element.textContent=e,this},this.type=function(e){return this.element.type=e,this},this.appendTo=function(e){return e instanceof ElementBuilder?e.build().appendChild(this.element):e.appendChild(this.element),this},this.placeholder=function(e){return this.element.placeholder=e,this},this.hide=function(){return this.element.style.display="none",this},this.show=function(){return this.element.style.display="block",this},this.className=function(e){return this.element.className=e,this},this.onclick=function(e){return this.element.onclick=e,this},this.html=function(e){return this.element.innerHTML=e,this},this.value=function(e){return this.element.value=e,this},this.build=function(){return this.element},this.width=function(e){return this.element.width=e,this},this.on=function(e,t){return this.element.addEventListener(e,t),this},this.getValue=function(){return this.element.value},this.src=function(e){return this.element.src=e,this},this.dataset=function(e){return this.element.dataset=e,this}}ElementBuilder.getInstance=function(){return{create:function(e){return new ElementBuilder(e)}}};const SAMPLE_DATA='{\n    "items": [\n      {\n        "sys": { "id": "1" },\n        "fields": {\n          "title": "queen panel bed",\n          "price": 10.99,\n          "image": { "fields": { "file": { "url": "./images/product-1.jpeg" } } }\n        }\n      },\n      {\n        "sys": { "id": "2" },\n        "fields": {\n          "title": "king panel bed",\n          "price": 12.99,\n          "image": { "fields": { "file": { "url": "./images/product-2.jpeg" } } }\n        }\n      },\n      {\n        "sys": { "id": "3" },\n        "fields": {\n          "title": "single panel bed",\n          "price": 12.99,\n          "image": { "fields": { "file": { "url": "./images/product-3.jpeg" } } }\n        }\n      },\n      {\n        "sys": { "id": "4" },\n        "fields": {\n          "title": "twin panel bed",\n          "price": 22.99,\n          "image": { "fields": { "file": { "url": "./images/product-4.jpeg" } } }\n        }\n      },\n      {\n        "sys": { "id": "5" },\n        "fields": {\n          "title": "fridge",\n          "price": 88.99,\n          "image": { "fields": { "file": { "url": "./images/product-5.jpeg" } } }\n        }\n      },\n      {\n        "sys": { "id": "6" },\n        "fields": {\n          "title": "dresser",\n          "price": 32.99,\n          "image": { "fields": { "file": { "url": "./images/product-6.jpeg" } } }\n        }\n      },\n      {\n        "sys": { "id": "7" },\n        "fields": {\n          "title": "couch",\n          "price": 45.99,\n          "image": { "fields": { "file": { "url": "./images/product-7.jpeg" } } }\n        }\n      },\n      {\n        "sys": { "id": "8" },\n        "fields": {\n          "title": "table",\n          "price": 33.99,\n          "image": { "fields": { "file": { "url": "./images/product-8.jpeg" } } }\n        }\n      }\n    ]\n  }\n  ';class Product{constructor({id:e,title:t,price:n,image:i}){this.id=e,this.title=t,this.price=n,this.image=i}render(){const e=ElementBuilder.getInstance().create("article").className("product"),t=ElementBuilder.getInstance().create("div").className("img-container").appendTo(e);ElementBuilder.getInstance().create("img").className("product-img").src(this.image).appendTo(t);const n=ElementBuilder.getInstance().create("button").dataset({id:this.id}).html('<i class="fas fa-shopping-cart"></i>Add to cart').className("bag-btn").appendTo(t).on("click",()=>{cart.add(this.id)});return ElementBuilder.getInstance().create("i").className("fas fa-shopping-cart").appendTo(n),ElementBuilder.getInstance().create("h3").text(this.title).appendTo(e),e.build()}}class ProductManager{constructor(){const e=JSON.parse(SAMPLE_DATA);this.products=e.items.map(e=>new Product({id:e.sys.id,title:e.fields.title,price:e.fields.price,image:e.fields.image.fields.file.url}))}render(){const e=document.querySelector(".products-center");this.products.forEach(t=>{e.appendChild(t.render())})}get(e){return this.products.find(t=>t.id===e)}}const manager=new ProductManager;manager.render();class CartItem{constructor({productId:e,onInc:t,onDec:n}){this.productId=e,this.quantity=1,this.product=manager.get(e),this.onInc=t,this.onDec=n}inc(){this.quantity++}dec(){return--this.quantity}getPrice(){return this.product.price*this.quantity}render(){const e=ElementBuilder.getInstance().create("div").className("cart-item");ElementBuilder.getInstance().create("img").src(this.product.image).appendTo(e);const t=ElementBuilder.getInstance().create("div").appendTo(e);ElementBuilder.getInstance().create("h4").text(this.product.title).appendTo(t),ElementBuilder.getInstance().create("h5").text(this.product.price).appendTo(t),ElementBuilder.getInstance().create("span").className("remove-item").dataset({id:this.productId}).text("remove").appendTo(t);const n=ElementBuilder.getInstance().create("div").appendTo(e);return ElementBuilder.getInstance().create("i").dataset({id:this.productId}).className("fas fa-chevron-up").on("click",()=>this.onInc(this.productId)).appendTo(n),ElementBuilder.getInstance().create("p").className("item-amount").text(this.quantity).appendTo(n),ElementBuilder.getInstance().create("i").dataset({id:this.productId}).className("fas fa-chevron-down").on("click",()=>this.onDec(this.productId)).appendTo(n),e.build()}}class Cart{constructor({cartContent:e,cartTotal:t,clearBtn:n,cartItemsTotalContainer:i}){this.open=!1,this.items=[],this.cartContent=e,this.cartTotal=t,this.clearBtn=n,this.cartItemsTotalContainer=i}toggle(){const e=document.querySelector(".cart-overlay"),t=document.querySelector(".cart");this.open?(e.classList.remove("transparentBcg"),t.classList.remove("showCart"),this.open=!1):(e.classList.add("transparentBcg"),t.classList.add("showCart"),this.open=!0)}add(e){const t=this.items.find(t=>t.productId===e);t?t.inc():this.items.push(new CartItem({productId:e,onInc:this.inc.bind(this),onDec:this.dec.bind(this)})),this.render()}remove(e){this.items=this.items.filter(t=>t.productId!==e),this.render()}inc(e){const t=this.items.find(t=>t.productId===e);t&&(t.inc(),this.render())}dec(e){const t=this.items.find(t=>t.productId===e);if(t){0===t.dec()&&this.remove(e),this.render()}}clear(){this.items=[],this.toggle(),this.render()}render(){this.cartContent.innerHTML="";let e=0,t=0;this.items.forEach(n=>{e+=n.getPrice(),t+=n.quantity,this.cartContent.appendChild(n.render())}),this.cartTotal.textContent=e,this.cartItemsTotalContainer.textContent=t}}const cart=new Cart({cartContent:document.querySelector(".cart-content"),cartTotal:document.querySelector(".cart-total"),clearBtn:document.querySelector(".clear-cart"),cartItemsTotalContainer:document.querySelector(".cart-items")}),cartBtn=document.querySelector(".cart-btn"),closeBtn=document.querySelector(".close-cart"),clearBtn=document.querySelector(".clear-cart");clearBtn.addEventListener("click",()=>cart.clear()),cartBtn.addEventListener("click",()=>cart.toggle()),closeBtn.addEventListener("click",()=>cart.toggle());